{% extends 'base.html' %}
{% block content %}
  <section class="card">
    <a href="{{ url_for('admin_reporters') }}">&larr; Back to reporters</a>
    <h2>{{ reporter.full_name }}</h2>
    <p>{{ reporter.email }}{% if reporter.phone %} · {{ reporter.phone }}{% endif %}</p>
  </section>

  <section class="card" style="margin-top:1.5rem;">
    <h3>Filed reports</h3>
    {% if reports %}
      <table>
        <thead>
          <tr>
            <th>Date</th>
            <th>Complainant</th>
            <th>Category</th>
            <th>Counselor</th>
            <th>Verification</th>
          </tr>
        </thead>
        <tbody>
          {% for row in reports %}
            <tr>
              <td>{{ row.created_at }}</td>
              <td>{{ row.complainant_name or '—' }}<br /><small>{{ row.complainant_phone }}</small></td>
              <td><a href="{{ url_for('admin_reporter_report_detail', reporter_id=reporter.id, report_id=row.id) }}">{{ row.predicted_label }}</a></td>
              <td>
                {% if row.counselor_name %}
                  {{ row.counselor_name }}<br /><small>{{ row.counselor_email }}</small>
                {% else %}
                  <small>Unassigned</small>
                {% endif %}
              </td>
              <td>
                <form method="post" action="{{ url_for('admin_verify_report', report_id=row.id) }}">
                  <input type="hidden" name="redirect_to" value="{{ url_for('admin_reporter_reports', reporter_id=reporter.id) }}" />
                  <label style="display:flex;align-items:center;gap:0.4rem;">
                    <input type="checkbox" name="verified" value="1" {% if row.verified %}checked{% endif %} onchange="this.form.submit()" />
                    <span>{{ 'Verified' if row.verified else 'Pending' }}</span>
                  </label>
                </form>
              </td>
            </tr>
          {% endfor %}
        </tbody>
      </table>
    {% else %}
      <p>No reports submitted yet.</p>
    {% endif %}
  </section>
{% endblock %}
