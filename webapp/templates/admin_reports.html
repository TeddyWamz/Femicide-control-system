{% extends 'base.html' %}
{% block content %}
  <section class="card">
    <h2>Reports overview</h2>
    {% if stats %}
      <div class="grid two">
        {% for row in stats %}
          <div style="background:#f4f1ff;border-radius:14px;padding:1rem;">
            <h4 style="margin:0 0 0.3rem;">{{ row.predicted_label }}</h4>
            <strong style="font-size:2rem;">{{ row.total }}</strong>
            <p style="margin:0;color:#6b6a7b;">Filed cases</p>
          </div>
        {% endfor %}
      </div>
    {% else %}
      <p>No reports have been filed yet.</p>
    {% endif %}
  </section>

  <section class="card" style="margin-top:2rem;">
    <h3>Recent incidents</h3>
    {% if reports %}
      <table>
        <thead>
          <tr>
            <th>Date</th>
            <th>Complainant</th>
            <th>Location</th>
            <th>Category</th>
            <th>Confidence</th>
            <th>Reporter</th>
            <th>Counselor</th>
            <th>Status</th>
          </tr>
        </thead>
        <tbody>
          {% for row in reports %}
            <tr>
              <td>{{ row.created_at }}</td>
              <td>
                {{ row.complainant_name or '—' }}<br />
                <small>{{ row.complainant_phone }}</small>
              </td>
              <td>
                {{ row.address or '—' }}{% if row.area %}<br /><small>{{ row.area }}</small>{% endif %}
              </td>
              <td>{{ row.predicted_label }}</td>
              <td>{{ '{:.2%}'.format(row.confidence) }}</td>
              <td>{{ row.reporter_name }}<br /><small>{{ row.reporter_email }}</small></td>
              <td>
                {% if row.counselor_name %}
                  {{ row.counselor_name }}<br /><small>{{ row.counselor_email }}</small>
                {% else %}
                  <small>Unassigned</small>
                {% endif %}
              </td>
              <td>{{ 'Verified' if row.verified else 'Pending review' }}</td>
            </tr>
          {% endfor %}
        </tbody>
      </table>
    {% else %}
      <p>No incidents to display.</p>
    {% endif %}
  </section>
{% endblock %}
